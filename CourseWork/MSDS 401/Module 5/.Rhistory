theme(legend.title = element_blank(), legend.position = c(0.9, 0.85))
#Create barplot with ggplot2
ggplot(data = mydata, aes(x = CLASS, fill = factor(SEX, levels = c("F","I","M"))))+
geom_bar() +
labs(x = 'Class', y = 'Frequency', title = "CLASS membership, SEX-differentiated") +
scale_fill_manual(labels = c("Female","Infant","Male"),values = c("darkred", "darkblue", "darkgreen")) +
theme_minimal() +
theme(legend.title = element_blank(), legend.position = c(0.9, 0.85))
ggplot(data = mydata, aes(x = CLASS, fill = factor(SEX, levels = c("F","I","M"))))+
geom_bar(position = "dodge") +
labs(x = 'Class', y = 'Frequency', title = "CLASS membership, SEX-differentiated") +
scale_fill_manual(labels = c("Female","Infant","Male"),values = c("darkred", "darkblue", "darkgreen")) +
theme_minimal() +
theme(legend.title = element_blank(), legend.position = c(0.9, 0.85))
row.id <- seq(from = 1, to = 1036, by = 1)
set.seed(123)
x <- seq(from = 1, to = 1036, by = 1)
sample(x, size = 200)
set.seed(123)
x <- seq(from = 1, to = 1036, by = 1)
row.id <- sample(x, size = 200)
set.seed(123)
x <- seq(from = 1, to = 1036, by = 1)
row.id <- sample(x, size = 200)
work <- mydata[row.id,]
work
set.seed(123)
x <- seq(from = 1, to = 1036, by = 1)
row.id <- sample(x, size = 200)
work <- mydata[row.id,]
set.seed(123)
x <- seq(from = 1, to = 1036, by = 1)
row.id <- sample(x, size = 200)
work <- mydata[row.id,]
#Construct scatterplot matrix of work variables
plot(work[, 2:6])
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
geom_point()
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
geom_point() +
labs(xlab = "Volume", ylab = "Whole Weight",
title = "Whole weight, in grams | Volume, cm^3")
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
geom_point() +
labs(xlab = "Volume", ylab = "Whole Weight",
title = "Whole weight, in grams | Volume, cm^3") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
geom_point() +
labs(xlab = "Volume", ylab = "Whole Weight",
title = expression("Whole weight, in grams | Volume, cm"^3) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
geom_point() +
labs(xlab = "Volume", ylab = "Whole Weight",
title = expression("Whole weight, in grams | Volume, cm"^3)) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = mydata, aes(x = WHOLE, y = SHUCK, color = CLASS)) +
geom_point()
ggplot(data = mydata, aes(x = WHOLE, y = SHUCK, color = CLASS)) +
geom_point() +
labs(xlab = "Whole weight", ylab = "Shuck weight",
title = "Shuck weight, in grams | Whole weight, in grams" ) +
theme(plot.title = element_text(hjust = 0.5))
#Create ggplot2 plot
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
geom_point() +
labs(x = "Volume", y = "Whole Weight",
title = expression("Whole weight, in grams | Volume, cm"^3)) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = mydata, aes(x = WHOLE, y = SHUCK, color = CLASS)) +
geom_point() +
labs(x = "Whole weight", y = "Shuck weight",
title = "Shuck weight, in grams | Whole weight, in grams" ) +
theme(plot.title = element_text(hjust = 0.5))
max.shuck.whole <- max(mydata$SHUCK/mydata$WHOLE)
max.shuck.whole
mydata$SHUCK/mydata$WHOLE
str(mydata$SHUCK/mydata$WHOLE)
plt <- ggplot(data = mydata, aes(x = WHOLE, y = SHUCK, color = CLASS)) +
geom_point() +
labs(x = "Whole weight", y = "Shuck weight",
title = "Shuck weight, in grams | Whole weight, in grams" ) +
theme(plot.title = element_text(hjust = 0.5))
plt
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dashed", size = 1)
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dashed", size = 0.5)
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dashed", size = 0.1)
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dashed", size = 0.25)
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dotted", size = 0.25)
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dotted", size = 0.5)
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dotdash", size = 0.5)
plt <- ggplot(data = mydata, aes(x = WHOLE, y = SHUCK, color = CLASS)) +
geom_point() +
labs(x = "Whole weight", y = "Shuck weight",
title = "Shuck weight, in grams | Whole weight, in grams" ) +
theme(plot.title = element_text(hjust = 0.5))
plt
#Create ggplot object for SHUCK vs. WHOLE
plt <- ggplot(data = mydata, aes(x = WHOLE, y = SHUCK, color = CLASS)) +
geom_point() +
labs(x = "Whole weight", y = "Shuck weight",
title = "Shuck weight, in grams | Whole weight, in grams" ) +
theme(plot.title = element_text(hjust = 0.5))
#Find max value of the ratio of SHUCK to WHOLE
max.shuck.whole <- max(mydata$SHUCK/mydata$WHOLE)
#Add a straight line with zero intercept using max ratio as slope
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dotdash", size = 0.5)
summary(mydata$SEX)
# MSDS 401 Data Analysis Assignment Demonstration
# Note-In Course Reserves you will find Chapter 2 of Chihara and Hesterbery's book.
# This chapter is devoted to EDA and presents several EDA methods.
require(moments)
require(ggplot2)
# The Consumer Food Database is described in the "Analyzing the Databases" section
# of Chapter 1 Black page 15.
food <- read.csv(file.path("/Users/mikeysoukup/Desktop/NU MSDS/MSDS 401/Module 5/Food.csv"),sep=",")
str(food)
# The variables Region and Location are read in as integers.  They are nominal
# variables and can not be used as such.  They will need to be factored.
summary(food[,1:3])
plot(food[,1:3])
# Define factors which will be used for displays and contingency tables.
# Label as indicated S for South, NE for Northeast, MW for Midwest, W for West.
# Label metro location as M, and not metro location as NM. Also define
# the variable ratio as spending divided by income.
location <- factor(food$Location, labels = c("M", "NM"))
region <- factor(food$Region, labels = c("NE","MW","S","W"))
ratio <- food$Spending/food$Income
food <- data.frame(food, region, location, ratio)
str(food)
summary(food$ratio)
# Investigate the relationship between Income and Spending differentiated by
# region and by location.  Using ggplot2 for line plots and scatter plots is
# discussed in the "R Graphics Cookbook" by Chang in Chapters 4 and 5.
# Statistical graphics is discussed by Lander in Chapter 7.
ggplot(data = food, aes(x = Income, y = Spending)) +
geom_point(aes(color = region),size = 3) + ggtitle("Spending versus Income by Region")
ggplot(data = food, aes(x = Income, y = Spending)) +
geom_point(aes(color = location),size = 3) + ggtitle("Spending versus Income by Location")
# Investigate the distribution of the data. The boxplots reveal outliers.
par(mfrow = c(2,3))
hist(food$Income, col = "red")
hist(food$Spending, col = "blue")
hist(food$ratio, col = "green")
boxplot(food$Income, col = "red")
boxplot(food$Spending, col = "blue")
boxplot(food$ratio,col = "green")
par(mfrow = c(1,1))
female.ratio <- mydata$RATIO[mydata$SEX = 'F']
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 2, add = TRUE)
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 1, add = TRUE)
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred', xaxt = 'n')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 1, add = TRUE)
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred', xaxt = 'n')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 1)
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred', xlab = '')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 1)
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred', xlab = '')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen', xlab = '')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue', xlab = '')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 1)
qqnorm(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
qqline(infant.ratio, col = 'black', lty = 1)
qqnorm(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqline(male.ratio, col = 'black', lty = 1)
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred', xlab = '')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen', xlab = '')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue', xlab = '')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 1)
qqnorm(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
qqline(infant.ratio, col = 'black', lty = 1)
qqnorm(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqline(male.ratio, col = 'black', lty = 1)
par(mfrow = c(1,1))
?kable
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
boxplot.stats(female.ratio, coef = 1.5)
boxplot.stats(female.ratio, coef = 1.5)$out
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mile.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
f.extreme.outliers <- boxplot.stats(female.ratio, coef = 3)$out
i.extreme.outliers <- boxplot.stats(infant.ratio, coef = 3)$out
m.extreme.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
f.extreme.outliers
i.extreme.outliers
m.extreme.outliers
m.extreme.outliers <- boxplot.stats(male.ratio, coef = 3)$out
m.extreme.outliers
?boxplot
#Bring back in SEX subsetted RATIO data
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(2,3))
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred', range = 1.5)
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen', range = 1.5)
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue', range = 1.5)
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
f.extreme.outliers <- boxplot.stats(female.ratio, coef = 3)$out
i.extreme.outliers <- boxplot.stats(infant.ratio, coef = 3)$out
m.extreme.outliers <- boxplot.stats(male.ratio, coef = 3)$out
par(mfrow = c(1,1))
#Bring back in SEX subsetted RATIO data
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(2,3))
boxplot(female.ratio, main = 'Female RATIO mild outliers', col = 'darkred', range = 1.5)
boxplot(infant.ratio, main = 'Infant RATIO mild outliers', col = 'darkgreen', range = 1.5)
boxplot(male.ratio, main = 'Male RATIO mild outliers', col = 'darkblue', range = 1.5)
boxplot(female.ratio, main = 'Female RATIO extreme outliers', col = 'darkred', range = 3)
boxplot(infant.ratio, main = 'Infant RATIO extreme outliers', col = 'darkgreen', range = 3)
boxplot(male.ratio, main = 'Male RATIO extreme outliers', col = 'darkblue', range = 3)
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
f.extreme.outliers <- boxplot.stats(female.ratio, coef = 3)$out
i.extreme.outliers <- boxplot.stats(infant.ratio, coef = 3)$out
m.extreme.outliers <- boxplot.stats(male.ratio, coef = 3)$out
par(mfrow = c(1,1))
f.out <- mydata[mydata$RATIO == f.mild.outliers]
f.out <- mydata[which(mydata$RATIO == f.mild.outliers)]
f.mild.outliers
mydata[mydata$SEX == 'F' & mydata$RATIO == f.mild.outliers]
which(mydata$SEX = 'F')
which(mydata$SEX == 'F')
myF <- mydata[mydata$SEX == 'F',]
myF
myF[myF$RATIO == f.mild.outliers]
mydata[mydata$SEX == 'F' & mydata$RATIO %in% f.mild.outliers]
mydata[mydata$SEX == 'F' & mydata$RATIO %in% f.mild.outliers,]
#Bring back in SEX subsetted RATIO data
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(2,3))
boxplot(female.ratio, main = 'Female RATIO mild outliers', col = 'darkred', range = 1.5)
boxplot(infant.ratio, main = 'Infant RATIO mild outliers', col = 'darkgreen', range = 1.5)
boxplot(male.ratio, main = 'Male RATIO mild outliers', col = 'darkblue', range = 1.5)
boxplot(female.ratio, main = 'Female RATIO extreme outliers', col = 'darkred', range = 3)
boxplot(infant.ratio, main = 'Infant RATIO extreme outliers', col = 'darkgreen', range = 3)
boxplot(male.ratio, main = 'Male RATIO extreme outliers', col = 'darkblue', range = 3)
par(mfrow = c(1,1))
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
Fout <- mydata[mydata$SEX == 'F' & mydata$RATIO %in% f.mild.outliers]
#Bring back in SEX subsetted RATIO data
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(2,3))
boxplot(female.ratio, main = 'Female RATIO mild outliers', col = 'darkred', range = 1.5)
boxplot(infant.ratio, main = 'Infant RATIO mild outliers', col = 'darkgreen', range = 1.5)
boxplot(male.ratio, main = 'Male RATIO mild outliers', col = 'darkblue', range = 1.5)
boxplot(female.ratio, main = 'Female RATIO extreme outliers', col = 'darkred', range = 3)
boxplot(infant.ratio, main = 'Infant RATIO extreme outliers', col = 'darkgreen', range = 3)
boxplot(male.ratio, main = 'Male RATIO extreme outliers', col = 'darkblue', range = 3)
par(mfrow = c(1,1))
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
Fout <- mydata[mydata$SEX == 'F' & mydata$RATIO %in% f.mild.outliers,]
Iout <- mydata[mydata$SEX == 'I' & mydata$RATIO %in% i.mild.outliers,]
Mout <- mydata[mydata$SEX == 'M' & mydata$RATIO %in% m.mild.outliers,]
out.df <- data.frame(Fout, Iout, Mout)
Fout
Fout + Iout
kable(Fout)
kable(Fout, Iout, Mout)
kable(Iout)
outliers <- rbind(Fout, Iout, Mout)
kable(outliers)
#Bring back in SEX subsetted RATIO data
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(2,3))
boxplot(female.ratio, main = 'Female RATIO mild outliers', col = 'darkred', range = 1.5)
boxplot(infant.ratio, main = 'Infant RATIO mild outliers', col = 'darkgreen', range = 1.5)
boxplot(male.ratio, main = 'Male RATIO mild outliers', col = 'darkblue', range = 1.5)
boxplot(female.ratio, main = 'Female RATIO extreme outliers', col = 'darkred', range = 3)
boxplot(infant.ratio, main = 'Infant RATIO extreme outliers', col = 'darkgreen', range = 3)
boxplot(male.ratio, main = 'Male RATIO extreme outliers', col = 'darkblue', range = 3)
par(mfrow = c(1,1))
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
Fout <- mydata[mydata$SEX == 'F' & mydata$RATIO %in% f.mild.outliers,]
Iout <- mydata[mydata$SEX == 'I' & mydata$RATIO %in% i.mild.outliers,]
Mout <- mydata[mydata$SEX == 'M' & mydata$RATIO %in% m.mild.outliers,]
abalone.outliers <- rbind(Fout, Iout, Mout)
kable(abalone.outliers)
abalone.outliers
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(2,3))
boxplot(female.ratio, main = 'Female RATIO mild outliers', col = 'darkred', range = 1.5)
boxplot(infant.ratio, main = 'Infant RATIO mild outliers', col = 'darkgreen', range = 1.5)
boxplot(male.ratio, main = 'Male RATIO mild outliers', col = 'darkblue', range = 1.5)
boxplot(female.ratio, main = 'Female RATIO extreme outliers', col = 'darkred', range = 3)
boxplot(infant.ratio, main = 'Infant RATIO extreme outliers', col = 'darkgreen', range = 3)
boxplot(male.ratio, main = 'Male RATIO extreme outliers', col = 'darkblue', range = 3)
par(mfrow = c(1,1))
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
Fout <- mydata[mydata$SEX == 'F' & mydata$RATIO %in% f.mild.outliers,]
Iout <- mydata[mydata$SEX == 'I' & mydata$RATIO %in% i.mild.outliers,]
Mout <- mydata[mydata$SEX == 'M' & mydata$RATIO %in% m.mild.outliers,]
abalone.outliers <- rbind(Fout, Iout, Mout)
kable(abalone.outliers)
# DO NOT ADD OR REVISE CODE HERE
knitr::opts_chunk$set(echo = FALSE, eval = TRUE)
library(ggplot2)
library(gridExtra)
library(knitr)
# b) Use read.csv() to read the abalones.csv into R, assigning the data frame to "mydata."
mydata <- read.csv("/Users/mikeysoukup/Desktop/NU MSDS/MSDS 401/Module 5/abalones.csv", sep = ",", stringsAsFactors = TRUE)
# c) Use the str() function to verify the structure of "mydata." You should have 1036 observations
# of eight variables.
str(mydata)
# d) Define two new variables, VOLUME and RATIO. Use the following statements to define VOLUME and
# RATIO as variables appended to the data frame "mydata."
mydata$VOLUME <- mydata$LENGTH * mydata$DIAM * mydata$HEIGHT
mydata$RATIO <- mydata$SHUCK / mydata$VOLUME
str(mydata)
#Obtain descriptive statistics from mydata
summary(mydata)
#Use table to present a frequency table using CLASS and RINGS from mydata
table(mydata$RINGS, mydata$CLASS)
#Add a margin to sum each row and column of the table
addmargins(table(mydata$RINGS,mydata$CLASS))
#First create table object
part.1b <- table(mydata$SEX, mydata$CLASS)
#Add margins and display
addmargins(table(mydata$SEX, mydata$CLASS))
#Create barplot with base R graphics
barplot(part.1b, ylab = "Frequency", main = "CLASS membership, SEX-differentiated",
col = c("darkred", "darkblue", "darkgreen"), legend = c("Female","Infant","Male"),
names.arg = colnames(part.1b), beside = TRUE)
#Create barplot with ggplot2
ggplot(data = mydata, aes(x = CLASS, fill = factor(SEX, levels = c("F","I","M"))))+
geom_bar(position = "dodge") +
labs(x = 'Class', y = 'Frequency', title = "CLASS membership, SEX-differentiated") +
scale_fill_manual(labels = c("Female","Infant","Male"),values = c("darkred", "darkblue", "darkgreen")) +
theme_minimal() +
theme(legend.title = element_blank(), legend.position = c(0.9, 0.85))
#Create random sample of 200 rows from mydata and label sample as work
set.seed(123)
x <- seq(from = 1, to = 1036, by = 1)
row.id <- sample(x, size = 200)
work <- mydata[row.id,]
#Construct scatterplot matrix of work variables
plot(work[, 2:6])
#Create ggplot2 plot
ggplot(data = mydata, aes(x = VOLUME, y = WHOLE, color = CLASS)) +
geom_point() +
labs(x = "Volume", y = "Whole Weight",
title = expression("Whole weight, in grams | Volume, cm"^3)) +
theme(plot.title = element_text(hjust = 0.5))
#Create ggplot object for SHUCK vs. WHOLE
plt <- ggplot(data = mydata, aes(x = WHOLE, y = SHUCK, color = CLASS)) +
geom_point() +
labs(x = "Whole weight", y = "Shuck weight",
title = "Shuck weight, in grams | Whole weight, in grams" ) +
theme(plot.title = element_text(hjust = 0.5))
#Find max value of the ratio of SHUCK to WHOLE
max.shuck.whole <- max(mydata$SHUCK/mydata$WHOLE)
#Add a straight line with zero intercept using max ratio as slope
plt +
geom_abline(intercept = 0, slope = max.shuck.whole, color = "black",
linetype = "dotdash", size = 0.5)
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(3,3))
hist(female.ratio, ylab = 'Frequency', main = 'Female RATIO', col = 'darkred', xlab = '')
hist(infant.ratio, ylab = 'Frequency', main = 'Infant RATIO', col = 'darkgreen', xlab = '')
hist(male.ratio, ylab = 'Frequency', main = 'Male RATIO', col = 'darkblue', xlab = '')
boxplot(female.ratio, main = 'Female RATIO', col = 'darkred')
boxplot(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
boxplot(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqnorm(female.ratio, main = 'Female RATIO', col = 'darkred')
qqline(female.ratio, col = 'black', lty = 1)
qqnorm(infant.ratio, main = 'Infant RATIO', col = 'darkgreen')
qqline(infant.ratio, col = 'black', lty = 1)
qqnorm(male.ratio, main = 'Male RATIO', col = 'darkblue')
qqline(male.ratio, col = 'black', lty = 1)
par(mfrow = c(1,1))
#Bring back in SEX subsetted RATIO data
female.ratio <- mydata$RATIO[mydata$SEX == 'F']
infant.ratio <- mydata$RATIO[mydata$SEX == 'I']
male.ratio <- mydata$RATIO[mydata$SEX == 'M']
par(mfrow = c(2,3))
boxplot(female.ratio, main = 'Female RATIO mild outliers', col = 'darkred', range = 1.5)
boxplot(infant.ratio, main = 'Infant RATIO mild outliers', col = 'darkgreen', range = 1.5)
boxplot(male.ratio, main = 'Male RATIO mild outliers', col = 'darkblue', range = 1.5)
boxplot(female.ratio, main = 'Female RATIO extreme outliers', col = 'darkred', range = 3)
boxplot(infant.ratio, main = 'Infant RATIO extreme outliers', col = 'darkgreen', range = 3)
boxplot(male.ratio, main = 'Male RATIO extreme outliers', col = 'darkblue', range = 3)
par(mfrow = c(1,1))
f.mild.outliers <- boxplot.stats(female.ratio, coef = 1.5)$out
i.mild.outliers <- boxplot.stats(infant.ratio, coef = 1.5)$out
m.mild.outliers <- boxplot.stats(male.ratio, coef = 1.5)$out
Fout <- mydata[mydata$SEX == 'F' & mydata$RATIO %in% f.mild.outliers,]
Iout <- mydata[mydata$SEX == 'I' & mydata$RATIO %in% i.mild.outliers,]
Mout <- mydata[mydata$SEX == 'M' & mydata$RATIO %in% m.mild.outliers,]
abalone.outliers <- rbind(Fout, Iout, Mout)
kable(abalone.outliers)
abalone.outliers
